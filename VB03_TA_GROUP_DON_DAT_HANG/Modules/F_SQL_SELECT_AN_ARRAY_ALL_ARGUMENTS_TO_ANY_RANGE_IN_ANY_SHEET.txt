Function F_SQL_SELECT_AN_ARRAY_ALL_ARGUMENTS_TO_ANY_RANGE_IN_ANY_SHEET(Var_query As String, DestinyRange As String, DestinySheet As String, ServerName As String, DatabaseName As String, LoginName As String, LoginPass As String)

    On Error GoTo ErrorHandler
    Dim MyArray() As Variant    'unbound Array with no definite dimensions'
    Dim Dest_range As range
    Dim I As Integer, j As Integer, colcnt As Integer, rowcnt As Integer
    
    Call S_SET_SQL_CONNECTION_ALL_ARGUMENT_SQLNCLI11(ServerName, DatabaseName, LoginName, LoginPass)
    
'    Debug.Print VAR_CONN_ALL_ARGUMENT_RECORDSET.State
    VAR_CONN_ALL_ARGUMENT_RECORDSET.CursorLocation = adUseClient
    VAR_CONN_ALL_ARGUMENT_RECORDSET.Open Var_query, VAR_CONN_ALL_ARGUMENT_CONNECTION, adOpenStatic
    ' VAR_CONN_ALL_ARGUMENT_RECORDSET.Open Source, ActiveConnection, CursorType, LockType, Options
    ' CusorType có 5 hang so lan luot la: adOpenDynamic = 2, adOpenForwardOnly = 0, adOpenKeyset =1, adOpenStatic = 3, adOpenUnspecified= -1
    ' Locktype có 5 hang so lan luot là: adLockBatchOptimistic= 4, adLockOptimistic=3, adLockPessimistic=2, adLockReadOnly=1, adLockUnspecified=-1
    
'    Debug.Print VAR_CONN_ALL_ARGUMENT_RECORDSET.State
    If VAR_CONN_ALL_ARGUMENT_RECORDSET.RecordCount <> 0 Then            '///Do NOT Use "Do While Not rst.EOF" Can cause Problems///'
        colcnt = VAR_CONN_ALL_ARGUMENT_RECORDSET.Fields.count - 1
        rowcnt = VAR_CONN_ALL_ARGUMENT_RECORDSET.RecordCount
     Else
        ' Reset Error Trapping
        On Error GoTo 0
        Exit Function
    End If
'====================================...WRITE VAR_CONN_ALL_ARGUMENT_RECORDSET TO MYARRAY
    ReDim MyArray(rowcnt, colcnt)  'Redimension MyArray parameters to fit the SQL returned'
    VAR_CONN_ALL_ARGUMENT_RECORDSET.MoveFirst

    'Populating Array with Headers from VAR_CONN_ALL_ARGUMENT_RECORDSET'
    For j = 0 To colcnt
         MyArray(0, j) = VAR_CONN_ALL_ARGUMENT_RECORDSET.Fields(j).Name
    Next

    'Populating Array with Record Data
    For I = 1 To rowcnt
        For j = 0 To colcnt
            MyArray(I, j) = VAR_CONN_ALL_ARGUMENT_RECORDSET(j)
        Next j
        VAR_CONN_ALL_ARGUMENT_RECORDSET.MoveNext
    Next I
    
'    S_SQL_SELECT_AN_ARRAY_01 = MyArray
'====================================...WORKSHEET OUTPUT
'    Debug.Print UBound(MyArray, 1) + 1
'    Debug.Print UBound(MyArray, 2) + 1
'    SH_DASHBOARD.Range("A1").Resize(UBound(MyArray, 1) + 1, UBound(MyArray, 2) + 1).Value = MyArray
'    SH_DASHBOARD.Range("AN2").Resize(UBound(MyArray, 1) + 1, UBound(MyArray, 2) + 1).Value = MyArray
    
    VAR_TABLE_RowsCount = UBound(MyArray, 1) + 1
    VAR_TABLE_ColumnsCount = UBound(MyArray, 2) + 1
    
'    Call F_FIND_RANGE_IN_SH_ALL_RANGES_01(DestinyRange)
'    Set Dest_range = F_FIND_RANGE_IN_SH_ALL_RANGES_01(DestinyRange)
    Set Dest_range = F_FIND_ANY_RANGE_IN_ANY_SHEET_01(DestinyRange, DestinySheet)
    Dest_range.ClearContents
    Dest_range.Resize(UBound(MyArray, 1) + 1, UBound(MyArray, 2) + 1).Value = MyArray   'Resize (secret sauce)
    ' Reset Error Trapping
    On Error GoTo 0
    If VAR_CONN_ALL_ARGUMENT_RECORDSET.State = 1 Then
        VAR_CONN_ALL_ARGUMENT_RECORDSET.Close
    End If
    Set VAR_CONN_ALL_ARGUMENT_RECORDSET = Nothing: Set VAR_CONN_ALL_ARGUMENT_CONNECTION = Nothing
    Exit Function

ErrorHandler:
    Call S_THONG_BAO_LOI
    Call S_XU_LY_LOI
    ' Reset Error Trapping
    On Error GoTo 0
    If VAR_CONN_ALL_ARGUMENT_RECORDSET.State = 1 Then
        VAR_CONN_ALL_ARGUMENT_RECORDSET.Close
    End If
    Set VAR_CONN_ALL_ARGUMENT_RECORDSET = Nothing: Set VAR_CONN_ALL_ARGUMENT_CONNECTION = Nothing
    Exit Function
'    Resume
End Function